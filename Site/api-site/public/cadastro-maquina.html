<!DOCTYPE html>
<html lang="pt">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Boxicons -->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet" rel='stylesheet'>
	<!-- My CSS -->
	<link rel="stylesheet" href="./css/cadastros-logado.css">
	<link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0"/>
	<script type="text/javascript" src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
	<link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
	<link rel="stylesheet" href="./css/modal.css">
	
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<title>DataCat</title>
	
</head>

<body onload='listarMaquina()'>

	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			<img src="./assets/imagens/logo/logo-black.png"
				alt="">
			<span class="text">DataCat</span>
		</a>
		<ul class="side-menu top">
			<li>
				<a href=".//dashboard/dashboard.html">
					<span class="material-icons-sharp">
						grid_view
					</span>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="./cadastro-funcionario.html">
					<span class="material-icons-sharp">
						perm_identity
					</span>
					<span class="text">Cadastrar usuário</span>
				</a>
			</li>
			<li class="active">
				<a href="./cadastro-maquina.html">
					<span class="material-icons-sharp">add_to_queue</span>
					<span>Cadastrar máquina</span>
				</a>
			</li>

		</ul>
		<ul class="side-menu">
			<li>
				<a href="login.html" onclick="limparSessao()" class="logout">
					<span class="material-icons-sharp">logout</span>
					<span class="text">Sair</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->



	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu'></i>
			<!-- <span class="material-icons-sharp"> -->


			<a href="#" class="nav-link">Categorias</a>
			<form action="#">
				<div class="form-input">

				</div>
			</form>
			<input type="checkbox" id="switch-mode" hidden>
			<label for="switch-mode" class="switch-mode"></label>
			<a href="#" class="notification">
				<span class="material-icons-sharp">
					notifications
				</span>
				<span class="num">8</span>
			</a>
			<a href="#" class="profile">
				<img src="./assets/fotos/leticia.jfif">
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
			<div class="head-title">
				<div class="left">
					<h1>Cadastro Máquina / Servidor</h1>
					<ul class="breadcrumb">
						<li>
							<a href="#">Dashboard</a>
						</li>
						<li><i class='bx bx-chevron-right'></i></li>
						<li>
							<a class="active" href="#">Cadastro Máquina / Servidor</a>
						</li>
					</ul>
				</div>
			
			</div>


			<div>
           <div id="div_formulario_upDateMaquina"></div>

			<div class="box-info-funcionario">
				<h1 class="identificacao">Identificação</h1>
				<h1>Componente</h1>
				<h1>Capacidade</h1>
				<h1>Alerta</h1>
				
			</div>
			<div id="listaMaquina"></div>
			<!-- The Modal -->

			

  <div id="myModal2" class="modal">
  
	<!-- Modal content -->
	<div class="modal-content">
	  <span class="close">&times;</span>
	  <p>
		  <div>
			  <div class="box-subscribe">
				  <div class="subscribe-left">
					  <div class="title-subscribe">
						  <h3>Delete um usuario do seu time </h3>
					  </div>
					  <img src="./assets/imagens/filing-system-amico.png" alt="">
				  </div>
				  
				  <div id="cadastro" class = "subscribe-right">
					  <form action="" id="form_deletarMaquina" method="post" onsubmit="return deletarMaquina()">
						  <label  for="">Identificador</label>
						  <input name="idMaquinaComponentes" type="text" required maxlength="15">
						  <label for="">Componente</label>
						  <input name="nome" type="text" required maxlength="45">
						  <div class="space-btn">
						  <button class="btn"><h3><a>Deletar usuario</a></h3></button>
						  </div>
					  </form>
					  
				  
				  </div>
			  </div>
		  </div>	
	  </p>
	</div>
  
  </div>
			<!-- <ul class="box-info">
				<li>
					
					<span class="text">
						<div class="div-title">
							<div class="icon">
						<span class="material-icons-sharp">	memory</span>
					       </div>
						<h3>Memória ram</h3>
					   </div>
					<div class="memoria">
					<canvas id="graficoMemoria"></canvas>
					<div>
			        
					</span>
				</li>
				</ul> -->
		</main>
		<!-- MAIN -->
	</section>
	<!-- CONTENT -->


	<!-- <script src="script.js"></script> -->

</body>

</html>
<script>

function cadastrarMaquina() {
    var myInput = document.getElementById("idEmpresa");
    myInput.value = sessionStorage.ID_EMPRESA;
        var formulario = new URLSearchParams(new FormData(document.getElementById("form_cadastroMaquina")));
        
        var identPessoal = formulario.get("identPessoal");
        var hostName = formulario.get("hostName");
        var grupo = formulario.get("grupo");
        var idEmpresa = sessionStorage.ID_EMPRESA;
        
        
        // TODO: VERIFICAR AS VALIDAÇÕES QUE ELES ESTÃO APRENDENDO EM ALGORITMOS 
        if (hostName == "" || grupo == "" || nome == "" || identPessoal == "" || idEmpresa == "" ) {
        
        window.alert("Preencha todos os campos para prosseguir!");
            if (hostName == "" ) {
                console.log("hostName está em branco!");
            }
            if (grupo == "") {
                console.log('grupo está em branco')
            }
            if (nome == "") {
                console.log("nome está em branco!");
            }
                return false;
            }
        
        fetch("/usuarios/cadastrarMaquina", {
        method: "POST",
        body: formulario,
        }).then(function (resposta) {
        
        console.log("resposta: ", resposta);
        
        if (resposta.ok) {
            window.alert("Cadastro realizado com sucesso!");
            limparFormulario2() 
        } else {
            throw ("Houve um erro ao tentar realizar o cadastro!");
        }
        }).catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        });

		fetch("/usuarios/cadastrarComponente", {
        method: "POST",
        body: formulario,
        }).then(function (resposta) {
        
        console.log("resposta: ", resposta);
        
        if (resposta.ok) {
            window.alert("Cadastro realizado com sucesso!");
            limparFormulario2() 
        } else {
            throw ("Houve um erro ao tentar realizar o cadastro!");
        }
        }).catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        });

        return false;
    }

	const allSideMenu = document.querySelectorAll('#sidebar .side-menu.top li a');

	allSideMenu.forEach(item => {
		const li = item.parentElement;

		item.addEventListener('click', function () {
			allSideMenu.forEach(i => {
				i.parentElement.classList.remove('active');
			})
			li.classList.add('active');
		})
	});




	// TOGGLE SIDEBAR
	const menuBar = document.querySelector('#content nav .bx.bx-menu');
	const sidebar = document.getElementById('sidebar');

	menuBar.addEventListener('click', function () {
		sidebar.classList.toggle('hide');
	})







	const searchButton = document.querySelector('#content nav form .form-input button');
	const searchButtonIcon = document.querySelector('#content nav form .form-input button .bx');
	const searchForm = document.querySelector('#content nav form');

	searchButton.addEventListener('click', function (e) {
		if (window.innerWidth < 576) {
			e.preventDefault();
			searchForm.classList.toggle('show');
			if (searchForm.classList.contains('show')) {
				searchButtonIcon.classList.replace('bx-search', 'bx-x');
			} else {
				searchButtonIcon.classList.replace('bx-x', 'bx-search');
			}
		}
	})





	if (window.innerWidth < 768) {
		sidebar.classList.add('hide');
	} else if (window.innerWidth > 576) {
		searchButtonIcon.classList.replace('bx-x', 'bx-search');
		searchForm.classList.remove('show');
	}


	window.addEventListener('resize', function () {
		if (this.innerWidth > 576) {
			searchButtonIcon.classList.replace('bx-x', 'bx-search');
			searchForm.classList.remove('show');
		}
	})

</script>

<script src="./js/funcoes.js"></script>

 <script src="./js/Deletes.js"></script>

<script src="./js/upDates.js"></script>

<script src="./js/Cadastrar.js"></script>

<script src="./js/Listar.js"></script> 

